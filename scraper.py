# This scraper parses HTML from the Cybersecurity and Infrastructure Agency (CISA) for known exploited vulnerabilites (KEVs).
import requests
from bs4 import BeautifulSoup

page = 1
kev_pages = []
while page < 6:
    URL = f"https://www.cisa.gov/known-exploited-vulnerabilities-catalog?page={page}"
    response = requests.get(URL)
    page = page + 1
    soup = BeautifulSoup(response.content, "html.parser")
    job_elements = soup.find_all("div", class_="c-view__row")

    for job_element in job_elements:
        number_element = job_element.find("h3", class_="c-teaser__title")
        name_element = job_element.find("div", class_='c-teaser__vuln-name')
        summary_element = job_element.find("div", class_="c-teaser__summary")

        print("Number:", number_element.text.strip())
        print("Title:", name_element.text.strip())
        print("Summary:", summary_element.text.strip(), end="\n"*2)

        kev_pages.append(number_element.text.strip())

print("Total KEVs printed:", len(kev_pages))